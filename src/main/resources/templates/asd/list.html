<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>[글 목록]</title>
</head>
<body>
<header>
	<h1>목록</h1>
</header>
<section>
	<!-- 글 목록이 들어가는 곳 -->
	<!-- 객체를 필드 이름만 사용해서 표시하고 싶을때 -->
	<!-- *{필드이름} -->
	<div id="container">
		<!-- 인증 정보에 따른 내용표시 -->
		<div sec:authorize="not isAuthenticated()">
			<p>GUEST님 안녕하세요.</p>
			<P>
				<!-- 현재 url에 따라서 login, join만 써놓으면 -->
				<!-- 상대주소로 인식한다.(board/login 처럼) -->
				<!-- 그래서 최상위(/)부터 시작하는 절대주소를 기입 -->
				<a th:href="@{/member/login}">로그인</a>
				<a th:href="@{/member/join}">회원가입</a>
			</P>
		</div>
		<div sec:authorize = "isAuthenticated()">
			<p>
				<span sec:authentication="name"></span>님 안녕하세요!
			</p>
			<p>
				<input type="button" value = "글쓰기" onclick="javascript:location.href='write'">
			</p>		
		</div>
		<!-- 등록된 글의 개수 -->
		<p>
			게시판에 등록된 글은 <span th:text="${navi.totalRecordsCount}"></span>개입니다.
		</p>
		<table>
			<tr>
				<th>글번호</th>
				<th>제목</th>
				<th>글쓴이</th>
				<th>작성 시간</th>
				<th>조회수</th>
			</tr>
			<!-- 타임리프의 객체 반복 -->
			<tr th:each="board : ${boardList}">
				<td th:text="${board.boardNum}"></td>
				<td>
					<a th:href = "@{|read?num=${board.boardNum}|}">
						<span th:text="${board.title}"></span>
						<span th:if="${board.savedFile != null}" th:text="|♥|"></span>
					</a>
				</td>
				<!-- ajax 테스트를 위한 td -->
				<td>
					<a th:href = "@{|ajaxRead?num=${board.boardNum}|}">
						<span th:text="${board.title}"></span>
					</a>
				</td>
				<td th:text="${board.nickname}"></td>
				<td th:text="${board.inputDate}"></td>
				<td th:text="${board.viewCount}"></td>
			</tr>
		</table>
	</div>
	<div id="navigator">
		<!-- 페이지 이동 링크 -->
		<!-- 이전 페이지 그룹으로 이동 -->
		<a th:href="|javascript:pagingFormSubmit(${navi.currentPage - navi.pagePerGroup})|" th:text = "|◁◁|"></a>
		<a th:href = "|javascript:pagingFormSubmit(${navi.currentPage - 1})|" th:text="|◀|"></a>
		<span th:each = "counter : ${#numbers.sequence(navi.startPageGroup, navi.endPageGroup)}">
			<th:block th:if = "${counter == navi.currentPage}"><b></th:block>
			<a th:text = "${counter}" th:href = "|javascript:pagingFormSubmit(${counter})|"></a>
			<th:block th:if = "${counter == navi.currentPage}"></b></th:block>
		</span>
		<!-- 다음 페이지 그룹으로 이동 -->
		<a th:href = "|javascript:pagingFormSubmit(${navi.currentPage + 1})|" th:text="|▶|"></a>
		<a th:href = "|javascript:pagingFormSubmit(${navi.currentPage + navi.pagePerGroup})|" th:text="|▷▷|"></a>
	</div>
	<!-- 검색창 -->
	<div><!-- search는 임시주소임 -->
		<form th:action="@{list}" method="GET" id="pagingForm">
			<input type="hidden" id="page" name="page">
			<select id="type" name="type">
				<!-- th:selected 속성을 사용해서 조건에 맞는 항목을 선택된 채로 있게 한다. -->
				<option value="title" th:selected="${type} == 'title'">제목</option>
				<option value="content" th:selected="${type} == 'content'">내용</option>
				<option value="memberId" th:selected="${type} == 'memberId'">작성자 ID</option>
			</select>
			<input type="text" name="searchWord" th:value="${searchWord}">
			<input type="submit" value="검색">
		</form>
	</div>
</section>
<script>
	
	
	
	function pagingFormSubmit(currentPage){
		
		let form = document.getElementById("pagingForm");
		let page = document.getElementById("page");
		
		page.value = currentPage;
		
		form.submit();
		
	} 
</script>
</body>
</html>