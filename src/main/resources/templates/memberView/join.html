<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"	
		xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
	<meta charset="UTF-8">
	<title>회원가입</title>
	<link rel = "stylesheet" href = "/css/member/join_style.css">
	<link rel = "stylesheet" href = "/css/member/communityIndex.css">
</head>
<body>
	<!-- 헤더 윗 부분(로그인, 회원가입) -->
	<div class = "util">
		<!-- 인증되지 않은 사용자(비로그인 경우) -->
		<p sec:authorize = "not isAuthenticated()"><a th:href = "@{member/join}">회원가입</a></p>
		<p sec:authorize = "not isAuthenticated()"><a th:href = "@{member/login}">로그인</a></p>
		
		<!-- 인증된 사용자(로그인 경우) -->
		<p sec:authorize = "isAuthenticated()"><a th:href = "@{/update}">정보수정</a></p>
		<p sec:authorize = "isAuthenticated()"><a th:href = "@{/update}">로그아웃</a></p>
		
		
		<!-- 인증된 사용자의 닉네임 -->
		<p id = "WelcomMsg" sec:authorize = "isAuthenticated()"><span sec:authentication = 'nickname'> 님 안녕하세요.</span>
	</div> <!-- util 부분 끝 -->
	
	<!-- 메뉴 네비게이션(상의해야할 부분) 위치 -->
	<!--  회원가입 내용 들어갈 container -->
	<div class = "joinContainer">
		<!-- 회원가입 제목 -->
		<div class = "joinTitle">
			<h2>회원가입</h2>
		</div>
		<!-- 회원가입 내용 -->
		<div class = "joinContent">
		
			<!-- 서버에 보낼 링크와 방식 -->
			<form action = "join" method = "post" onsubmit = "return checkValues();">
			
				<!-- 회원가입 기본정보 -->
				<fieldset class = "requiredInfo">
					<legend>기본정보</legend>
					<!-- 아이디 -->
					<label for = "memberId">아이디</label>
					<div class = "joinIdWrap">
					<input type = "text" id = "memberId" name = "memberId" placeholder = "중복확인 버튼을 눌러주세요." maxlength = "30" readonly required>
	    			<input type = "button" id = "memberIdChk" value = "ID 중복확인 하기" onclick = "openIdForm();"><br>
					</div> <!--joinIdWrap 부분 끝-->
					
					<!-- 비밀번호 -->
					<label for = "memberPw">비밀번호</label><br>
					<input type = "password" id = "memberPw" name = "memberPw" placeholder = "비밀번호를 입력해주세요." required>
					
					<!-- 비밀번호 확인 -->
					<label for = "memberPwChk">비밀번호 확인</label>
					<input type = "password" id = "memberPwChk" placeholder = "비밀번호를 한번 더 입력해주세요." required>
					
					<!-- 이름 -->
					<label for = "memberName">이름</label>
					<input type = "text" id = "memberName" name = "name" placeholder = "이름을 입력해주세요." required>
					
					<!-- 닉네임 -->
					<label for = "nickname">닉네임</label>
					<input type = "text" id = "nickname" name = "nickname" placeholder = "닉네임을 입력해주세요." required>
					
					<!-- 주소 -->
					<label for = "address">주소</label>
					<input type = "text" id = "sample4_roadAddress" class = "address1" name = "address" placeholder="주소찾기를 눌러주세요." readonly>
					<input type = "button" value = "주소찾기" class = "addressFind" onclick = "sample4_execDaumPostcode()">
					<input type = "text" class = "address1" id = "sample4_detailAddress" placeholder = "상세 주소를 입력해주세요.">
					
					<input type = "hidden" id = "sample4_postcode" placeholder = "우편번호">
					<input type = "hidden" id = "sample4_jibunAddress" placeholder = "지번주소">
					<span id="guide" style="color:#999;display:none"></span>
					<input type="hidden" id="sample4_extraAddress" placeholder="참고항목">
					
					<!-- 전화번호 -->
					<label for = "phone">전화번호</label>
					<input type = "text" id = "phone" name = "phone" placeholder = "전화번호를 입력해주세요." required>
					
				</fieldset> <!-- 회원가입 정보입력 끝 -->
			
				<fieldset class = "buttons">
					<legend>버튼</legend>
					<button type = "submit">회원가입</button>
					<button type = "reset">취소하기</button>
				</fieldset> <!-- buttons 부분 끝 -->
		
		</div><!-- joinContent 부분 끝 -->
	</div>
	<script>
	
	function checkValues() {
		let memberId = document.getElementById('memberId');
		let memberPw = document.getElementById('memberPw');
		let memberPwChk = document.getElementById('memberPwChk');
		let memberName = document.getElementById('memberName');
		let phone = document.getElementById('phone');
		
		// ID 체크
		if(memberId.value.trim().length == 0) {
			alert('아이디는 필수 항목입니다.');
			memberId.focus();
			return false;
		} else if(memberId.value.trim().length < 4 || memberId.value.trim().length > 10) {
			alert('아이디는 4~10자 사이로 입력해주세요');
			memberId.focus;
			return false;
		}
		
		// 비밀번호 체크
		if(memberPw.value.trim().length == 0) {
			alert('비밀번호는 필수 항목입니다');
			memberPw.focus();
			return false;
		} else if(memberPw.value.trim().length < 4 || memberPw.value.trim().length > 10){
			alert('비밀번호는 4~10자 사이로 입력하세요');
			memberPw.focus();
			return false;
		} else if(memberPw.value.trim() != memberPwChk.value.trim()) {
			alert('비밀번호가 일치하지 않습니다.');
			memberPw.focus();
			return false;
		}
		
		// 이름 체크
		if(memberName.value.trim().length == 0){
			alert('이름은 필수 항목입니다');
			memberName.focus();
			return false;
		} else if(memberName.value.trim().length < 2 || memberName.value.trim().length > 6) {
			alert('이름은 2~6자로 입력하세요');
			memberName.focus();
			return false;
		}
		
		// 이름에 숫자가 있으면 경고 표시
		let nameValue = memberName.value;
		
		for(let i = 0; i < nameValue.length; i++){
			// i번 방에 있는 글자가 숫자라면
			if(!isNaN(nameValue.charAt(i))) {
				let message = 
					"이름에 " + nameValue.charAt(i) + "은 사용할 수 없습니다.";
				alert(message);
				memberName.focus;
				return false;
			}
		}
		
		// 전화번호 체크
		if(phone.value.trim().length == 0) {
			alert('전화번호는 필수 항목입니다.');
			phone.focus();
			return false;
		} else if(phone.value.trim().length != 11) {
			alert('전화번호는 숫자 11자리로 입력해주세요(-제외)');
			phone.focus();
			return false;
		}
		
		// 전화번호에 글자가 있으면 경고 표시
		let phoneValue = phone.value;
		
		for(let i = 0; i < phoneValue.length; i++){
			// i번 방에 있는 글자가 글자라면
			if(isNaN(phoneValue.indexOf(i))) {
				let message = 
					"전화번호는 숫자 11자리로 입력해주세요(-제외)";
				alert(message);
				phone.focus;
				return false;
			}
		}
	}
	
	function openIdForm() {
		// window.open('호출할 주소', '새창의 이름', '창의 위치와 크기 등')
		window.open('idCheck', 'win', 'left=600, top=300, width=600, height=350, menubar=no' );
	}
	
	</script>


	<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
	<script>
	function sample4_execDaumPostcode() {
	new daum.Postcode({
	    oncomplete: function(data) {
	
	    	var roadAddr = data.roadAddress; // 도로명 주소 변수
	        var extraRoadAddr = ''; // 참고 항목 변수
	
	        if(data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
	            extraRoadAddr += data.bname;
	        }
	        if(data.buildingName !== '' && data.apartment === 'Y'){
	           extraRoadAddr += (extraRoadAddr !== '' ? ', ' + data.buildingName : data.buildingName);
	        }
	        if(extraRoadAddr !== ''){
	            extraRoadAddr = ' (' + extraRoadAddr + ')';
	        }
	
	        document.getElementById('sample4_postcode').value = data.zonecode;
	        document.getElementById("sample4_roadAddress").value = roadAddr;
	        document.getElementById("sample4_jibunAddress").value = data.jibunAddress;
	        
	        if(roadAddr !== ''){
	            document.getElementById("sample4_extraAddress").value = extraRoadAddr;
	        } else {
	            document.getElementById("sample4_extraAddress").value = '';
	        }
	
	        var guideTextBox = document.getElementById("guide");
	        if(data.autoRoadAddress) {
	            var expRoadAddr = data.autoRoadAddress + extraRoadAddr;
	            guideTextBox.innerHTML = '(예상 도로명 주소 : ' + expRoadAddr + ')';
	            guideTextBox.style.display = 'block';
	
	        } else if(data.autoJibunAddress) {
	            var expJibunAddr = data.autoJibunAddress;
	            guideTextBox.innerHTML = '(예상 지번 주소 : ' + expJibunAddr + ')';
	            guideTextBox.style.display = 'block';
	        } else {
	            guideTextBox.innerHTML = '';
	            guideTextBox.style.display = 'none';
	        }
	    }
	}).open();
	
	}
</script>
</body>
</html>